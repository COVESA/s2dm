<!-- Custom head -->

<link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css"
/>

<!-- Google tag (gtag.js) -->
<script async src="https://www.googletagmanager.com/gtag/js?id=G-N42SFQ45B4"></script>
<script>
 window.dataLayer = window.dataLayer || [];
 function gtag(){dataLayer.push(arguments);}
 gtag('js', new Date());

 gtag('config', 'G-N42SFQ45B4');
</script>

<script>
    console.log("<!-- Hacked together with <3 in emacs --->");

    // Configure search for both local and production environments
    window.DOKS_CONFIG = window.DOKS_CONFIG || {};
    window.DOKS_CONFIG.searchIndexUrl = "{{ "search-index.json" | absURL }}";

    // For backward compatibility with different search implementations
    window.searchIndexUrl = "{{ "search-index.json" | absURL }}";

    // Override fetch requests for search-index.json to use the correct URL
    const originalFetch = window.fetch;
    window.fetch = function(url, options) {
        if (typeof url === 'string' && url.includes('/search-index.json')) {
            // Redirect hardcoded search-index.json requests to the correct URL
            url = window.DOKS_CONFIG.searchIndexUrl;
        }
        return originalFetch.call(this, url, options);
    };
</script>
